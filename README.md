# C# & C++ Video Capture Application

## Overview
This project is a video capture application built with a **C#** GUI that interacts with a **C++ DLL** to handle video capture and rendering. The application allows users to capture video from either a webcam or a video file, and displays the video frames in a GUI window. The video processing is done using **MediaLooks SDK** for capturing and **OpenCV** for rendering, while the **C#** application provides the user interface.

## Features
- **Start Capture From WebCam**: Captures live video from an available webcam.
- **Start Capture From File**: Loads a video file and loops the playback from the first frame once the video ends.
- **Stop**: Stops the video capture process.
- **Real-Time Video Rendering**: Video frames are drawn onto the window generated by the C# form, but the drawing is handled in the C++ layer using OpenCV.

## Project Structure
The project is divided into two parts:
1. **C#**: Implements the graphical user interface (GUI) and delegates video capture tasks to the C++ DLL.
2. **C++**: Handles video capture from either a webcam or video file using the **MediaLooks SDK**, and renders each frame using **OpenCV**.

### C# Part
- Implements the **Windows Forms** application with three buttons:
  - **Start Capture From WebCam**
  - **Start Capture From File**
  - **Stop**
- Generates the window where the video frames are displayed (rendered by the C++ code).

### C++ Part
- Uses **MediaLooks SDK** to capture video from either a webcam or file.
- Uses **OpenCV** to draw the video frames onto the GUI window created by the C# form.

## Prerequisites
To run this project, you will need:
- **MediaLooks MFormats SDK** (for video capture).
- **OpenCV** (for frame rendering).
- **.NET Framework** (for the Windows Forms application).

## Setup and Installation
1. **Clone the repository**:
   ```bash
   git clone https://github.com/DenisKostyuk/VideoStreamHandler.git

### Install the dependencies:

- Install **MediaLooks SDK** and ensure it is properly set up in your environment.
- Install **OpenCV** and link the libraries in your C++ project.
- Ensure **.NET Framework** is installed for the C# application.

### Build the C++ DLL:

- Open the C++ project in Visual Studio.
- Ensure that the **MediaLooks SDK** and **OpenCV** are properly linked.
- Build the project to generate the DLL.

### Build the C# Application:

- Open the C# Windows Forms application in Visual Studio.
- Ensure the C++ DLL is properly referenced.
- Build the project.

### Run the Application:

- Launch the application. You can start video capture either from your webcam or a video file, and view the results directly in the GUI.

### How It Works

- The **C#** part generates a window with buttons for video capture options.
- When the user clicks one of the capture buttons, the **C++ DLL** takes over, using the **MediaLooks SDK** to capture video frames.
- The **OpenCV** library is used within the **C++ DLL** to draw the captured video frames directly onto the window created by the **C#** form.

### Screenshots
(Include screenshots of the application in action here)

### License
This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

### Acknowledgements

- [MediaLooks MFormats SDK](https://www.medialooks.com/mformats)
- [OpenCV](https://opencv.org/)
- .NET Framework for Windows Forms
